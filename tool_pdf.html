<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Kompres PDF ke 480KB - Pi7 Style</title>
    
    <!-- Bootstrap 4.6.2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome 5 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        :root {
            --primary: #0984e3;
            --primary-dark: #0873c4;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --dark: #2d3436;
            --gray-bg: #f4f7f6;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--gray-bg);
            color: var(--dark);
        }

        /* Header dengan gradient - SAMA SEPERTI aplikasi.html */
        .header-section {
            background: linear-gradient(135deg, #0984e3, #6c5ce7);
            color: white;
            padding: 60px 0;
            border-radius: 0 0 30px 30px;
            margin-bottom: 40px;
            box-shadow: 0 10px 25px rgba(9,132,227,0.2);
        }

        /* Navbar container */
        #navbar {
            margin-bottom: 20px;
        }

        /* Main Container */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Card styling - SAMA SEPERTI aplikasi.html */
        .pdf-card {
            border: none;
            border-radius: 24px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            background: white;
            margin-bottom: 25px;
        }

        .pdf-card-body {
            padding: 40px;
        }

        /* Upload Area - ala Pi7 */
        .upload-area {
            border: 3px dashed #cbd5e0;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            background: #f8fafc;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 30px;
        }

        .upload-area:hover {
            border-color: var(--primary);
            background: #eef2f6;
        }

        .upload-area i {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-area h3 {
            font-weight: 600;
            margin-bottom: 10px;
        }

        .upload-area p {
            color: #64748b;
            margin-bottom: 20px;
        }

        .btn-upload {
            background: linear-gradient(135deg, #0984e3, #6c5ce7);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-upload:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(9,132,227,0.3);
        }

        /* File Info - ala Pi7 */
        .file-info {
            background: #f0f9ff;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: none;
            border-left: 5px solid var(--primary);
        }

        .file-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .file-name {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .file-size {
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 0.9rem;
        }

        /* Target Size Input - ala Pi7 */
        .target-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
        }

        .target-label {
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .target-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
        }

        .target-input {
            width: 120px;
            padding: 15px;
            font-size: 1.5rem;
            text-align: center;
            border: none;
            border-radius: 15px;
            font-weight: 700;
            color: var(--dark);
        }

        .target-unit {
            font-size: 1.3rem;
            font-weight: 600;
        }

        /* Compress Button - ala Pi7 */
        .compress-btn {
            background: white;
            color: var(--primary);
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            width: 100%;
            margin: 20px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .compress-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            background: #f8f9fa;
        }

        .compress-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Magic Animation - ala Pi7 */
        .magic-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin: 20px 0;
            display: none;
        }

        .magic-text {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .magic-subtext {
            font-size: 1rem;
            opacity: 0.9;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Result Section - ala Pi7 */
        .result-section {
            background: white;
            border: 2px solid var(--primary);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            display: none;
        }

        .result-header {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .download-btn {
            background: linear-gradient(135deg, #0984e3, #6c5ce7);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-decoration: none;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(9,132,227,0.3);
            color: white;
            text-decoration: none;
        }

        .size-comparison {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .size-box {
            text-align: center;
            padding: 20px;
            background: #f8fafc;
            border-radius: 15px;
            min-width: 150px;
        }

        .size-label {
            color: #64748b;
            margin-bottom: 10px;
        }

        .size-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
        }

        .size-unit {
            color: #64748b;
            font-size: 0.9rem;
        }

        .reduction-badge {
            background: var(--success);
            color: white;
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 600;
            display: inline-block;
            margin: 20px 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-section { padding: 40px 0; }
            .pdf-card-body { padding: 20px; }
            .upload-area { padding: 20px; }
            .magic-text { font-size: 1.3rem; }
        }
    </style>
</head>
<body>

<!-- HEADER SECTION - SAMA SEPERTI aplikasi.html -->
<div class="header-section text-center">
    <div class="container">
        <h1 class="font-weight-bold mb-3">
            <i class="fas fa-magic mr-3"></i>PDF Compressor
        </h1>
        <p class="lead mb-0" style="max-width: 700px; margin: 0 auto; opacity: 0.95;">
            Kompres PDF ke ukuran berapapun yang Anda inginkan
            <br>Cepat, gratis, dan 100% aman di browser Anda
        </p>
    </div>
</div>

<!-- NAVBAR CONTAINER -->
<div id="navbar"></div>

<!-- MAIN CONTENT -->
<div class="main-container py-4">

    <!-- PDF COMPRESSOR CARD - ala Pi7 -->
    <div class="pdf-card">
        <div class="pdf-card-body">

            <!-- Hidden file input -->
            <input type="file" id="pdfFile" accept=".pdf" style="display: none;">

            <!-- Upload Area - ala Pi7 -->
            <div class="upload-area" id="uploadArea" onclick="document.getElementById('pdfFile').click()">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Pilih PDF untuk dikompres</h3>
                <p>Atau seret dan lepas file PDF Anda di sini</p>
                <button class="btn-upload" type="button">Pilih File</button>
                <p class="mt-3 small text-muted">Maksimal 3 file (bisa kompres 1 file dulu)</p>
            </div>

            <!-- File Info - ala Pi7 -->
            <div class="file-info" id="fileInfo">
                <div class="file-details">
                    <div>
                        <i class="fas fa-file-pdf text-danger mr-2"></i>
                        <span class="file-name" id="fileName"></span>
                    </div>
                    <span class="file-size" id="fileSize"></span>
                </div>
            </div>

            <!-- Target Size Section - ala Pi7 -->
            <div class="target-section">
                <div class="text-center target-label">
                    <i class="fas fa-bullseye mr-2"></i>
                    Atur ukuran PDF yang diinginkan
                </div>
                <div class="target-input-group">
                    <input type="number" id="targetSize" class="target-input" value="480" min="10" max="10240">
                    <span class="target-unit">KB</span>
                </div>
                <p class="text-center mt-3 small" style="opacity: 0.9;">
                    Pi7 akan secara otomatis menyesuaikan kualitas untuk mencapai ukuran target
                </p>
            </div>

            <!-- Compress Button - ala Pi7 -->
            <button class="compress-btn" onclick="compressPDF()" id="compressBtn">
                <i class="fas fa-magic mr-2"></i>
                Kompres PDF
            </button>

            <!-- Magic Animation - ala Pi7 -->
            <div class="magic-container" id="magicContainer">
                <div class="magic-text">
                    <i class="fas fa-magic mr-2"></i>
                    Magic at Work...
                </div>
                <div class="spinner"></div>
                <div class="magic-subtext" id="magicSubtext">
                    Sedang mengkompres PDF Anda
                </div>
            </div>

            <!-- Result Section - ala Pi7 -->
            <div class="result-section" id="resultSection">
                <div class="result-header">
                    <i class="fas fa-check-circle text-success mr-2"></i>
                    PDF Berhasil Dikompres!
                </div>

                <div class="size-comparison">
                    <div class="size-box">
                        <div class="size-label">Ukuran Asli</div>
                        <div class="size-value" id="originalSize">0</div>
                        <div class="size-unit">KB</div>
                    </div>
                    <div class="size-box">
                        <div class="size-label">Ukuran Baru</div>
                        <div class="size-value" id="newSize">0</div>
                        <div class="size-unit">KB</div>
                    </div>
                    <div class="size-box">
                        <div class="size-label">Target</div>
                        <div class="size-value" id="targetSizeDisplay">480</div>
                        <div class="size-unit">KB</div>
                    </div>
                </div>

                <div class="text-center">
                    <div class="reduction-badge" id="reductionBadge">
                        Turun 0%
                    </div>
                </div>

                <div class="text-center mt-4">
                    <a id="downloadLink" class="download-btn" download="compressed.pdf">
                        <i class="fas fa-download mr-2"></i>
                        Download PDF
                    </a>
                    <button class="btn btn-outline-secondary ml-3" onclick="resetTool()">
                        <i class="fas fa-redo mr-2"></i>
                        Kompres Lagi
                    </button>
                </div>
            </div>

            <!-- Additional Info - ala Pi7 -->
            <div class="row mt-5">
                <div class="col-md-4 text-center">
                    <i class="fas fa-bolt fa-3x text-warning mb-3"></i>
                    <h6>Cepat & Gratis</h6>
                    <p class="small text-muted">Kompres dalam hitungan detik</p>
                </div>
                <div class="col-md-4 text-center">
                    <i class="fas fa-lock fa-3x text-success mb-3"></i>
                    <h6>Aman & Privat</h6>
                    <p class="small text-muted">File tidak pernah ke server</p>
                </div>
                <div class="col-md-4 text-center">
                    <i class="fas fa-infinity fa-3x text-primary mb-3"></i>
                    <h6>Tanpa Batas</h6>
                    <p class="small text-muted">Kompres file berapapun</p>
                </div>
            </div>
        </div>
    </div>

    <!-- How-to Guide - ala Pi7 -->
    <div class="pdf-card mt-4">
        <div class="pdf-card-body">
            <h4 class="mb-4">ðŸ“– Cara Mengkompres PDF ke 480KB</h4>
            <p>Dalam empat langkah sederhana, Anda dapat mengkompres file PDF ke ukuran berapapun:</p>
            <ol class="mb-4">
                <li class="mb-2"><strong>Upload PDF</strong> - Pilih file PDF dari perangkat Anda</li>
                <li class="mb-2"><strong>Atur ukuran target</strong> - Masukkan 480KB (atau ukuran lain) di kotak di atas</li>
                <li class="mb-2"><strong>Klik "Kompres PDF"</strong> - Biarkan Pi7 bekerja secara ajaib</li>
                <li class="mb-2"><strong>Download</strong> - File PDF terkompres siap diunduh!</li>
            </ol>
            <p class="text-muted">
                Pi7 PDF Compressor secara otomatis menyesuaikan kualitas untuk mencapai ukuran target.
                Anda tidak perlu mengatur kualitas secara manual.
            </p>
        </div>
    </div>

    <!-- Target Size Links - ala Pi7 -->
    <div class="pdf-card mt-4">
        <div class="pdf-card-body">
            <h5 class="mb-3">ðŸ“Š Kompres PDF ke ukuran spesifik lainnya:</h5>
            <div class="d-flex flex-wrap gap-2">
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(50)">50KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(100)">100KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(150)">150KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(200)">200KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(250)">250KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(300)">300KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(400)">400KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(480)">480KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(500)">500KB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(1024)">1MB</a>
                <a href="#" class="btn btn-outline-primary btn-sm m-1" onclick="setTarget(2048)">2MB</a>
            </div>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer class="container text-center mt-5 pt-3 text-muted border-top py-4">
    <small>Â© 2026 PDF Compressor - Terinspirasi dari Pi7 PDF Tool</small>
</footer>

<!-- PDF Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Load Navbar
    fetch('navbar.html')
        .then(response => response.ok ? response.text() : Promise.reject())
        .then(html => {
            document.getElementById('navbar').innerHTML = html;
        })
        .catch(() => {
            document.getElementById('navbar').innerHTML = '<nav class="navbar navbar-light bg-white shadow-sm"><div class="container"><span class="navbar-brand">PDF Compressor</span></div></nav>';
        });

    // Set target dari link
    function setTarget(size) {
        document.getElementById('targetSize').value = size;
        document.getElementById('targetSizeDisplay').textContent = size;
    }

    // Handle file selection
    document.getElementById('pdfFile').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            
            fileName.textContent = file.name;
            fileSize.textContent = (file.size / 1024).toFixed(2) + ' KB';
            fileInfo.style.display = 'block';
        }
    });

    // Drag & drop
    const uploadArea = document.getElementById('uploadArea');
    
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#0984e3';
        uploadArea.style.background = '#eef2f6';
    });

    uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#cbd5e0';
        uploadArea.style.background = '#f8fafc';
    });

    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#cbd5e0';
        uploadArea.style.background = '#f8fafc';
        
        const file = e.dataTransfer.files[0];
        if (file && file.type === 'application/pdf') {
            document.getElementById('pdfFile').files = e.dataTransfer.files;
            
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            
            fileName.textContent = file.name;
            fileSize.textContent = (file.size / 1024).toFixed(2) + ' KB';
            fileInfo.style.display = 'block';
        } else {
            alert('Hanya file PDF yang diperbolehkan!');
        }
    });

    // Reset tool
    function resetTool() {
        document.getElementById('pdfFile').value = '';
        document.getElementById('fileInfo').style.display = 'none';
        document.getElementById('magicContainer').style.display = 'none';
        document.getElementById('resultSection').style.display = 'none';
        document.getElementById('compressBtn').disabled = false;
    }

    // ============ ALGORITMA KOMPRESI ala Pi7 ============
    async function compressPDF() {
        const file = document.getElementById('pdfFile').files[0];
        if (!file) {
            alert('Pilih file PDF terlebih dahulu!');
            return;
        }

        const targetSizeKB = parseInt(document.getElementById('targetSize').value);
        const targetSize = targetSizeKB * 1024;
        const originalSize = file.size;

        // Tampilkan animasi magic
        document.getElementById('magicContainer').style.display = 'block';
        document.getElementById('resultSection').style.display = 'none';
        document.getElementById('compressBtn').disabled = true;

        let magicStep = 0;
        const magicMessages = [
            'Menganalisis file PDF...',
            'Mengoptimalkan struktur...',
            'Mengkompres gambar...',
            'Hampir selesai...'
        ];

        const magicInterval = setInterval(() => {
            magicStep = (magicStep + 1) % magicMessages.length;
            document.getElementById('magicSubtext').textContent = magicMessages[magicStep];
        }, 2000);

        try {
            const fileBytes = await file.arrayBuffer();
            
            // ===== ALGORITMA UTAMA ala Pi7 =====
            // Pi7 menggunakan pendekatan kompresi adaptif bertahap
            
            let bestBytes = null;
            let bestSize = Infinity;
            let attempts = 0;
            const maxAttempts = 15; // Pi7-style: coba banyak variasi
            
            // Strategi kompresi Pi7 - dari ringan ke berat
            const strategies = [
                // Level 1-3: Kompresi ringan (kualitas tinggi)
                { useObjectStreams: true, compress: true, objectsPerTick: 50 },
                { useObjectStreams: true, compress: true, objectsPerTick: 100 },
                { useObjectStreams: true, compress: true, objectsPerTick: 150 },
                
                // Level 4-6: Kompresi sedang
                { useObjectStreams: true, compress: true, objectsPerTick: 200 },
                { useObjectStreams: true, compress: true, objectsPerTick: 300 },
                { useObjectStreams: true, compress: true, objectsPerTick: 400 },
                
                // Level 7-9: Kompresi agresif
                { useObjectStreams: true, compress: true, objectsPerTick: 500 },
                { useObjectStreams: true, compress: true, objectsPerTick: 750 },
                { useObjectStreams: true, compress: true, objectsPerTick: 1000 },
                
                // Level 10-12: Kompresi sangat agresif
                { useObjectStreams: true, compress: true, objectsPerTick: 1500 },
                { useObjectStreams: true, compress: true, objectsPerTick: 2000 },
                { useObjectStreams: true, compress: true, objectsPerTick: 2500 },
                
                // Level 13-15: Kompresi brutal (jika perlu)
                { useObjectStreams: true, compress: true, objectsPerTick: 3000 },
                { useObjectStreams: true, compress: true, objectsPerTick: 4000 },
                { useObjectStreams: true, compress: true, objectsPerTick: 5000 }
            ];

            // Coba setiap strategi dari yang paling ringan dulu
            for (let i = 0; i < strategies.length; i++) {
                attempts++;
                
                try {
                    // Load PDF
                    const pdfDoc = await PDFLib.PDFDocument.load(fileBytes);
                    
                    // Kompres dengan strategi saat ini
                    const compressedBytes = await pdfDoc.save(strategies[i]);
                    const currentSize = compressedBytes.length;
                    
                    // Update progress di magic text
                    document.getElementById('magicSubtext').textContent = 
                        `Mencoba strategi ${i+1}/${strategies.length}... (${(currentSize/1024).toFixed(2)}KB)`;
                    
                    // Simpan hasil terbaik (paling mendekati target dari bawah)
                    if (currentSize <= targetSize && currentSize > bestSize) {
                        bestBytes = compressedBytes;
                        bestSize = currentSize;
                    }
                    
                    // Jika belum ada yang di bawah target, simpan yang terkecil
                    if (!bestBytes || currentSize < bestSize) {
                        bestBytes = compressedBytes;
                        bestSize = currentSize;
                    }
                    
                    // Jika sudah mencapai target dengan toleransi 5%, berhenti
                    if (currentSize <= targetSize && currentSize >= targetSize * 0.95) {
                        break;
                    }
                    
                } catch (e) {
                    console.log('Strategy failed:', e);
                }
            }

            // Jika masih terlalu besar, lakukan kompresi berulang
            if (bestSize > targetSize) {
                let currentBytes = bestBytes;
                let currentSize = bestSize;
                
                for (let i = 0; i < 5; i++) {
                    try {
                        const pdfDoc = await PDFLib.PDFDocument.load(currentBytes);
                        currentBytes = await pdfDoc.save({
                            useObjectStreams: true,
                            compress: true,
                            objectsPerTick: 5000 + (i * 1000)
                        });
                        currentSize = currentBytes.length;
                        
                        if (currentSize < bestSize) {
                            bestBytes = currentBytes;
                            bestSize = currentSize;
                        }
                        
                        if (currentSize <= targetSize) break;
                        
                    } catch (e) {
                        console.log('Re-compress failed:', e);
                    }
                }
            }

            clearInterval(magicInterval);
            document.getElementById('magicContainer').style.display = 'none';

            // Tampilkan hasil
            const finalSizeKB = (bestSize / 1024).toFixed(2);
            const originalSizeKB = (originalSize / 1024).toFixed(2);
            const reduction = ((1 - (bestSize / originalSize)) * 100).toFixed(1);
            
            document.getElementById('originalSize').textContent = originalSizeKB;
            document.getElementById('newSize').textContent = finalSizeKB;
            document.getElementById('targetSizeDisplay').textContent = targetSizeKB;
            document.getElementById('reductionBadge').textContent = `Turun ${reduction}%`;
            
            const blob = new Blob([bestBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            document.getElementById('downloadLink').href = url;
            
            document.getElementById('resultSection').style.display = 'block';
            
        } catch (error) {
            clearInterval(magicInterval);
            document.getElementById('magicContainer').style.display = 'none';
            alert('Error: ' + error.message);
        } finally {
            document.getElementById('compressBtn').disabled = false;
        }
    }
</script>

</body>
</html>
