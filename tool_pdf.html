<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PDF Creator - Kompresi Brutal</title>
    
    <!-- Bootstrap 4.6.2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome 5 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        :root {
            --primary: #d63031;
            --primary-dark: #c0392b;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --dark: #2d3436;
            --gray-bg: #f4f7f6;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--gray-bg);
        }

        .header-section {
            background: linear-gradient(135deg, #d63031, #e74c3c);
            color: white;
            padding: 60px 0;
            border-radius: 0 0 30px 30px;
            margin-bottom: 40px;
            box-shadow: 0 10px 25px rgba(214,48,49,0.3);
        }

        #navbar { margin-bottom: 20px; }

        .pdf-card {
            border: none;
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            background: white;
            margin-bottom: 25px;
            border-left: 5px solid #d63031;
        }

        .pdf-card-body { padding: 30px; }

        /* Badge Brutal */
        .badge-brutal {
            background: linear-gradient(135deg, #d63031, #e74c3c);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(214,48,49,0.3);
        }

        /* Animasi Brutal */
        @keyframes brutalPulse {
            0% { transform: scale(1); background: #d63031; }
            50% { transform: scale(1.05); background: #e74c3c; }
            100% { transform: scale(1); background: #d63031; }
        }

        .brutal-animation {
            animation: brutalPulse 1s ease infinite;
            color: white;
            padding: 20px;
            border-radius: 50px;
            text-align: center;
            font-weight: 800;
            font-size: 1.3rem;
            margin: 20px 0;
            display: none;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 10px 30px rgba(214,48,49,0.5);
        }

        .brutal-animation i {
            margin-right: 10px;
            animation: spin 1.5s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Progress Bar Brutal */
        .progress-brutal {
            height: 20px;
            border-radius: 50px;
            margin: 25px 0;
            background: #fee9e1;
            border: 2px solid #d63031;
        }

        .progress-bar-brutal {
            background: linear-gradient(90deg, #d63031, #e74c3c);
            border-radius: 50px;
            font-weight: bold;
            font-size: 0.8rem;
            line-height: 20px;
        }

        /* File Info */
        .file-list {
            max-height: 200px;
            overflow-y: auto;
            border: 3px solid #fee9e1;
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            background: #fff5f5;
        }

        /* Tombol Brutal */
        .btn-brutal {
            border-radius: 50px;
            padding: 16px 30px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.1rem;
            transition: all 0.3s;
            border: none;
            background: linear-gradient(135deg, #d63031, #e74c3c);
            color: white;
            width: 100%;
            box-shadow: 0 10px 25px rgba(214,48,49,0.4);
        }

        .btn-brutal:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 35px rgba(214,48,49,0.6);
            color: white;
        }

        .btn-brutal:active {
            transform: scale(0.95);
        }

        /* Target Display */
        .target-display {
            background: #2d3436;
            color: white;
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            margin: 20px 0;
        }

        .target-number {
            font-size: 4rem;
            font-weight: 800;
            line-height: 1;
            color: #d63031;
            text-shadow: 0 0 20px rgba(214,48,49,0.5);
        }

        /* Result Box */
        .result-box {
            background: #2d3436;
            color: white;
            padding: 25px;
            border-radius: 20px;
            margin-top: 25px;
            display: none;
            border-left: 5px solid #d63031;
        }

        /* Info Cards */
        .info-card {
            background: linear-gradient(135deg, #2d3436, #1e272e);
            color: white;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
        }

        .info-icon {
            width: 60px;
            height: 60px;
            background: #d63031;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            margin: 0 auto 15px;
            box-shadow: 0 5px 15px rgba(214,48,49,0.5);
        }

        .footer-note {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-top: 40px;
        }
    </style>
</head>
<body>

<!-- HEADER SECTION - BRUTAL RED -->
<div class="header-section text-center">
    <div class="container">
        <h1 class="font-weight-bold mb-3 display-4">
            <i class="fas fa-skull mr-3"></i>PDF CRUSHER
        </h1>
        <p class="lead mb-0" style="max-width: 700px; margin: 0 auto; opacity: 0.95; font-weight: 600;">
            ðŸ”¥ KOMPRESI BRUTAL - PAKSA PDF KE UKURAN BERAPAPUN! ðŸ”¥
            <br>Tidak peduli kualitas, yang penting ukurannya sesuai target!
        </p>
    </div>
</div>

<!-- NAVBAR CONTAINER -->
<div id="navbar"></div>

<!-- MAIN CONTENT -->
<div class="container py-4">

    <!-- PDF TOOLS CARD -->
    <div class="pdf-card">
        <div class="pdf-card-body">
            
            <!-- Badge Brutal -->
            <div class="text-center">
                <span class="badge-brutal">
                    <i class="fas fa-skull mr-2"></i>
                    MODE BRUTAL - FORCE COMPRESSION
                </span>
            </div>

            <!-- Tab Navigation -->
            <ul class="nav nav-pills nav-fill mb-4" id="pdfTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="compress-tab" data-toggle="pill" href="#compress" role="tab">
                        <i class="fas fa-skull mr-2"></i> KOMPRESI BRUTAL
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="merge-tab" data-toggle="pill" href="#merge" role="tab">
                        <i class="fas fa-compress-alt mr-2"></i> GABUNGKAN PDF
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="image-tab" data-toggle="pill" href="#image" role="tab">
                        <i class="fas fa-image mr-2"></i> GAMBAR KE PDF
                    </a>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- TAB KOMPRESI BRUTAL (UTAMA) -->
                <div class="tab-pane fade show active" id="compress" role="tabpanel">
                    
                    <!-- Upload Area -->
                    <div class="row justify-content-center">
                        <div class="col-lg-8">
                            <div class="form-group">
                                <label class="font-weight-bold h5">
                                    <i class="fas fa-cloud-upload-alt mr-2 text-danger"></i>
                                    1. ðŸ”¥ UPLOAD PDF YANG AKAN DIHANCURKAN
                                </label>
                                <div class="custom-file mb-3">
                                    <input type="file" class="custom-file-input" id="compressFile" accept=".pdf" onchange="updateFileList('compress')">
                                    <label class="custom-file-label" for="compressFile">Pilih file PDF...</label>
                                </div>
                                <div id="compressFileList" class="file-list">
                                    <small class="text-muted">Belum ada file dipilih</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Target Size - BRUTAL -->
                    <div class="row justify-content-center mt-4">
                        <div class="col-lg-8">
                            <div class="target-display">
                                <label class="text-uppercase small font-weight-bold text-muted">TARGET UKURAN BRUTAL</label>
                                <div class="target-number">
                                    <span id="targetDisplay">480</span>
                                </div>
                                <div class="d-flex justify-content-center mt-3">
                                    <button class="btn btn-outline-light btn-sm mx-1" onclick="adjustTarget(-50)">-50KB</button>
                                    <button class="btn btn-outline-light btn-sm mx-1" onclick="adjustTarget(-10)">-10KB</button>
                                    <span class="mx-3 font-weight-bold">KB</span>
                                    <button class="btn btn-outline-light btn-sm mx-1" onclick="adjustTarget(10)">+10KB</button>
                                    <button class="btn btn-outline-light btn-sm mx-1" onclick="adjustTarget(50)">+50KB</button>
                                </div>
                                <input type="range" class="form-control-range mt-4" id="targetSlider" min="10" max="5000" value="480" step="10" oninput="updateTargetFromSlider(this.value)">
                            </div>
                        </div>
                    </div>

                    <!-- Kualitas Slider - BRUTAL (bisa 0%) -->
                    <div class="row justify-content-center mt-3">
                        <div class="col-lg-8">
                            <label class="font-weight-bold">
                                <i class="fas fa-image mr-2 text-warning"></i>
                                TINGKAT KEBRUTALAN (0% = HANCUR TOTAL, 100% = KUALITAS ASLI)
                            </label>
                            <div class="d-flex align-items-center">
                                <span class="mr-2 font-weight-bold text-danger">0%</span>
                                <input type="range" class="form-control-range" id="qualitySlider" min="0" max="100" value="30" step="5" oninput="updateQualityLabel(this.value)">
                                <span class="ml-2 font-weight-bold text-success">100%</span>
                            </div>
                            <div class="text-center mt-2">
                                <span class="badge badge-danger p-2" id="qualityValue">30%</span>
                                <small class="text-muted ml-2">Semakin rendah, semakin kecil ukuran</small>
                            </div>
                        </div>
                    </div>

                    <!-- Tombol KOMPRESI BRUTAL -->
                    <div class="row justify-content-center mt-5">
                        <div class="col-lg-6">
                            <button class="btn-brutal" onclick="brutalCompress()" id="compressBtn">
                                <i class="fas fa-skull mr-2"></i>
                                ðŸ”¥ KOMPRES BRUTAL KE TARGET ðŸ”¥
                            </button>
                        </div>
                    </div>

                    <!-- Animasi Brutal -->
                    <div id="brutalAnimation" class="brutal-animation">
                        <i class="fas fa-skull"></i>
                        SEDANG MENGHANCURKAN PDF... ðŸ”¥ðŸ”¥ðŸ”¥
                    </div>
                </div>

                <!-- TAB GABUNGKAN PDF -->
                <div class="tab-pane fade" id="merge" role="tabpanel">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="form-group">
                                <label class="font-weight-bold">
                                    <i class="fas fa-cloud-upload-alt mr-2 text-primary"></i>
                                    Pilih File PDF (urutkan sesuai keinginan)
                                </label>
                                <div class="custom-file mb-2">
                                    <input type="file" class="custom-file-input" id="mergeFiles" multiple accept=".pdf" onchange="updateFileList('merge')">
                                    <label class="custom-file-label" for="mergeFiles">Pilih file PDF...</label>
                                </div>
                                <div id="mergeFileList" class="file-list">
                                    <small class="text-muted">Belum ada file dipilih</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 d-flex align-items-end">
                            <button class="btn btn-primary btn-block" onclick="mergePDFs()">
                                <i class="fas fa-compress-alt mr-2"></i> Gabungkan PDF
                            </button>
                        </div>
                    </div>
                </div>

                <!-- TAB GAMBAR KE PDF -->
                <div class="tab-pane fade" id="image" role="tabpanel">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="form-group">
                                <label class="font-weight-bold">
                                    <i class="fas fa-images mr-2 text-success"></i>
                                    Pilih Gambar (JPG, PNG, GIF)
                                </label>
                                <div class="custom-file mb-2">
                                    <input type="file" class="custom-file-input" id="imageFiles" multiple accept="image/*" onchange="updateFileList('image')">
                                    <label class="custom-file-label" for="imageFiles">Pilih gambar...</label>
                                </div>
                                <div id="imageFileList" class="file-list">
                                    <small class="text-muted">Belum ada file dipilih</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="form-group">
                                <label class="font-weight-bold">Ukuran Halaman</label>
                                <select id="pageSize" class="form-control">
                                    <option value="auto">Auto</option>
                                    <option value="a4">A4</option>
                                    <option value="letter">Letter</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-lg-3 d-flex align-items-end">
                            <button class="btn btn-success btn-block" onclick="convertImagesToPDF()">
                                <i class="fas fa-image mr-2"></i> Konversi ke PDF
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Bar Brutal -->
            <div class="progress progress-brutal mt-4" id="progressContainer" style="display: none;">
                <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated progress-bar-brutal" 
                     role="progressbar" style="width: 0%">0%</div>
            </div>

            <!-- Result Box Brutal -->
            <div id="resultBox" class="result-box">
                <div class="d-flex justify-content-between align-items-center flex-wrap">
                    <div>
                        <i class="fas fa-skull fa-3x mr-3" style="color: #d63031;"></i>
                    </div>
                    <div class="flex-grow-1">
                        <span id="resultMessage" class="font-weight-bold h5"></span>
                        <br>
                        <span id="resultDetail" class="text-muted"></span>
                    </div>
                    <div class="mt-3 mt-sm-0">
                        <a id="downloadLink" class="btn btn-danger rounded-pill px-4" style="display: none;" download="crushed.pdf">
                            <i class="fas fa-download mr-2"></i> DOWNLOAD HASIL BRUTAL
                        </a>
                        <button class="btn btn-outline-light rounded-pill px-4 ml-2" onclick="resetTool()" style="display: none;" id="resetBtn">
                            <i class="fas fa-redo mr-2"></i> HANCURKAN LAGI
                        </button>
                    </div>
                </div>
            </div>

            <!-- Info Cards -->
            <div class="row mt-5">
                <div class="col-md-4">
                    <div class="info-card">
                        <div class="info-icon">
                            <i class="fas fa-bomb"></i>
                        </div>
                        <h6 class="font-weight-bold">BRUTAL FORCE</h6>
                        <p class="small">Memaksa PDF mencapai target berapapun</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="info-card">
                        <div class="info-icon">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <h6 class="font-weight-bold">SUPER CEPAT</h6>
                        <p class="small">Kompresi dalam hitungan detik</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="info-card">
                        <div class="info-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h6 class="font-weight-bold">100% OFFLINE</h6>
                        <p class="small">Privat & aman di browser</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer class="container text-center mt-5 pt-3 text-muted border-top py-4">
    <small>Â© 2026 PDF CRUSHER - Mode Brutal Activated ðŸ”¥</small>
</footer>

<!-- PDF Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>

<script>
    // Load Navbar
    fetch('navbar.html')
        .then(response => response.ok ? response.text() : Promise.reject())
        .then(html => {
            document.getElementById('navbar').innerHTML = html;
        })
        .catch(() => {
            document.getElementById('navbar').innerHTML = '<nav class="navbar navbar-light bg-white shadow-sm"><div class="container"><span class="navbar-brand">PDF CRUSHER</span></div></nav>';
        });

    // Update target dari slider
    function updateTargetFromSlider(value) {
        document.getElementById('targetDisplay').textContent = value;
    }

    function adjustTarget(change) {
        const slider = document.getElementById('targetSlider');
        let newValue = parseInt(slider.value) + change;
        if (newValue < 10) newValue = 10;
        if (newValue > 5000) newValue = 5000;
        slider.value = newValue;
        document.getElementById('targetDisplay').textContent = newValue;
    }

    function updateQualityLabel(value) {
        document.getElementById('qualityValue').textContent = value + '%';
    }

    // Update file list
    function updateFileList(type) {
        const fileInput = document.getElementById(
            type === 'merge' ? 'mergeFiles' : 
            type === 'image' ? 'imageFiles' : 'compressFile'
        );
        const listDiv = document.getElementById(type + 'FileList');
        
        const fileLabel = fileInput.nextElementSibling;
        if (fileInput.files.length > 0) {
            fileLabel.textContent = fileInput.files[0].name;
        } else {
            fileLabel.textContent = 'Pilih file...';
        }
        
        if (fileInput.files.length > 0) {
            let html = '<ul class="list-unstyled">';
            for (let i = 0; i < fileInput.files.length; i++) {
                const file = fileInput.files[i];
                const sizeKB = (file.size / 1024).toFixed(2);
                html += `<li><i class="fas fa-file-pdf text-danger mr-2"></i>${file.name} - ${sizeKB} KB</li>`;
            }
            html += '</ul>';
            listDiv.innerHTML = html;
        } else {
            listDiv.innerHTML = '<small class="text-muted">Belum ada file dipilih</small>';
        }
    }

    // Show progress
    function showProgress(percent) {
        document.getElementById('progressContainer').style.display = 'block';
        const progressBar = document.getElementById('progressBar');
        progressBar.style.width = percent + '%';
        progressBar.textContent = percent + '%';
    }

    // Show result
    function showResult(message, detail, downloadUrl = null) {
        document.getElementById('resultBox').style.display = 'block';
        document.getElementById('resultMessage').textContent = message;
        document.getElementById('resultDetail').textContent = detail;
        
        const downloadLink = document.getElementById('downloadLink');
        const resetBtn = document.getElementById('resetBtn');
        
        if (downloadUrl) {
            downloadLink.href = downloadUrl;
            downloadLink.style.display = 'inline-block';
            resetBtn.style.display = 'inline-block';
        }

        document.getElementById('progressContainer').style.display = 'none';
        document.getElementById('brutalAnimation').style.display = 'none';
    }

    // Reset tool
    function resetTool() {
        document.getElementById('resultBox').style.display = 'none';
        document.getElementById('progressContainer').style.display = 'none';
        document.getElementById('brutalAnimation').style.display = 'none';
        document.getElementById('compressFile').value = '';
        document.querySelector('.custom-file-label').textContent = 'Pilih file...';
        document.getElementById('compressFileList').innerHTML = '<small class="text-muted">Belum ada file dipilih</small>';
    }

    // ============ KOMPRESI BRUTAL ============
    async function brutalCompress() {
        const file = document.getElementById('compressFile').files[0];
        if (!file) {
            alert('Pilih file PDF dulu!');
            return;
        }

        const targetSizeKB = parseInt(document.getElementById('targetSlider').value);
        const targetSize = targetSizeKB * 1024;
        const quality = parseInt(document.getElementById('qualitySlider').value) / 100;
        
        // Tampilkan animasi brutal
        document.getElementById('brutalAnimation').style.display = 'block';
        document.getElementById('progressContainer').style.display = 'block';
        document.getElementById('compressBtn').disabled = true;

        try {
            const fileBytes = await file.arrayBuffer();
            
            // ===== ALGORITMA BRUTAL =====
            // Tidak peduli kualitas, yang penting ukuran tercapai!
            
            let currentBytes = fileBytes;
            let currentSize = fileBytes.length;
            let attempts = 0;
            const maxAttempts = 20; // Brutal: coba sampai 20 kali
            
            showProgress(10);
            
            while (currentSize > targetSize && attempts < maxAttempts) {
                attempts++;
                
                // Load PDF
                const pdfDoc = await PDFLib.PDFDocument.load(currentBytes);
                
                // Hitung tingkat kebrutalan berdasarkan sisa ukuran
                const remainingRatio = targetSize / currentSize;
                const brutalityLevel = Math.min(0.9, Math.max(0.1, remainingRatio * quality));
                
                // Kompres dengan tingkat kebrutalan yang meningkat setiap attempt
                const compressedBytes = await pdfDoc.save({
                    useObjectStreams: true,
                    compress: true,
                    objectsPerTick: 1000, // Super agresif
                    addDefaultPage: false,
                    updateFieldAppearances: false
                });
                
                currentBytes = compressedBytes;
                currentSize = compressedBytes.length;
                
                // Update progress
                const progress = 10 + (attempts / maxAttempts) * 80;
                showProgress(progress);
                
                // Jika masih terlalu besar, reload dan kompres lagi
                if (currentSize > targetSize) {
                    // Reload hasil kompresi untuk dikompres lagi
                    const tempDoc = await PDFLib.PDFDocument.load(currentBytes);
                    currentBytes = await tempDoc.save({
                        useObjectStreams: true,
                        compress: true,
                        objectsPerTick: 2000 // Lebih brutal
                    });
                    currentSize = currentBytes.length;
                }
            }
            
            // Jika masih belum mencapai target, lakukan kompresi SUPER BRUTAL
            if (currentSize > targetSize) {
                for (let i = 0; i < 5; i++) {
                    const pdfDoc = await PDFLib.PDFDocument.load(currentBytes);
                    currentBytes = await pdfDoc.save({
                        useObjectStreams: true,
                        compress: true,
                        objectsPerTick: 5000, // SUPER BRUTAL
                        updateFieldAppearances: false
                    });
                    currentSize = currentBytes.length;
                    
                    if (currentSize <= targetSize) break;
                }
            }

            showProgress(100);
            document.getElementById('brutalAnimation').style.display = 'none';
            
            // Hitung hasil
            const finalSizeKB = (currentSize / 1024).toFixed(2);
            const originalSizeKB = (file.size / 1024).toFixed(2);
            const reduction = ((1 - (currentSize / file.size)) * 100).toFixed(1);
            
            const blob = new Blob([currentBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            
            let message, detail;
            
            if (currentSize <= targetSize) {
                message = `âœ“ BERHASIL! PDF DIHANCURKAN KE ${finalSizeKB} KB ðŸ”¥`;
                detail = `Awal: ${originalSizeKB} KB | Turun ${reduction}% | Target ${targetSizeKB}KB TERCAPAI!`;
            } else {
                const diatas = (currentSize/1024 - targetSizeKB).toFixed(2);
                message = `âš ï¸ PDF TERKOMPRES KE ${finalSizeKB} KB`;
                detail = `Awal: ${originalSizeKB} KB | Masih ${diatas}KB di atas target. Coba turunkan kualitas!`;
            }
            
            showResult(message, detail, url);
            
        } catch (error) {
            alert('Error: ' + error.message);
        } finally {
            document.getElementById('compressBtn').disabled = false;
        }
    }

    // Merge PDFs
    async function mergePDFs() {
        const files = document.getElementById('mergeFiles').files;
        if (files.length < 2) {
            alert('Pilih minimal 2 file!');
            return;
        }

        showProgress(10);
        
        try {
            const mergedPdf = await PDFLib.PDFDocument.create();
            
            for (let i = 0; i < files.length; i++) {
                const fileBytes = await files[i].arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(fileBytes);
                const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                copiedPages.forEach(page => mergedPdf.addPage(page));
                showProgress(20 + (i * 70 / files.length));
            }

            const pdfBytes = await mergedPdf.save();
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            
            showProgress(100);
            showResult('âœ“ PDF berhasil digabungkan!', `${files.length} file`, url);
        } catch (error) {
            alert('Error: ' + error.message);
        }
    }

    // Convert Images to PDF
    async function convertImagesToPDF() {
        const files = document.getElementById('imageFiles').files;
        if (files.length === 0) {
            alert('Pilih gambar!');
            return;
        }

        showProgress(10);
        
        try {
            const pdfDoc = await PDFLib.PDFDocument.create();
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const imageBytes = await file.arrayBuffer();
                
                let image;
                if (file.type.includes('png')) {
                    image = await pdfDoc.embedPng(imageBytes);
                } else {
                    image = await pdfDoc.embedJpg(imageBytes);
                }

                const page = pdfDoc.addPage([image.width, image.height]);
                page.drawImage(image, {
                    x: 0,
                    y: 0,
                    width: image.width,
                    height: image.height,
                });
                
                showProgress(20 + (i * 70 / files.length));
            }

            const pdfBytes = await pdfDoc.save();
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            
            showProgress(100);
            showResult('âœ“ Gambar berhasil dikonversi!', `${files.length} gambar`, url);
        } catch (error) {
            alert('Error: ' + error.message);
        }
    }
</script>

</body>
</html>
