<nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm py-2">
    <div class="container">
        <!-- Brand/Logo - Diperkecil -->
        <a class="navbar-brand d-flex align-items-center" href="index.html">
            <img src="assets/img/logo/logo-tksk.png" alt="TKSK" height="35" class="d-inline-block align-text-top mr-2">
            <span class="fw-bold text-primary" style="font-size: 0.95rem; color: #0d6efd !important;">DARI DATA KE AKSI</span>
        </a>
        
        <!-- Mobile Toggle Button -->
        <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navbarNav" 
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"
                style="outline: none; box-shadow: none; padding: 6px 10px;">
            <span class="navbar-toggler-icon" style="width: 1.2em; height: 1.2em;"></span>
        </button>

        <!-- Navbar Collapse -->
        <div class="collapse navbar-collapse" id="navbarNav">
            <!-- Menu Utama - Dirapatkan -->
            <ul class="navbar-nav mx-auto" style="gap: 2px;">
                <!-- Beranda -->
                <li class="nav-item">
                    <a class="nav-link px-2 rounded-pill" href="index.html">
                        <i class="fas fa-home mr-1"></i> <span class="d-none d-lg-inline">Beranda</span>
                    </a>
                </li>

                <!-- Dropdown: Data DTSEN dan BANSOS - DIPENDEK -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle px-2 rounded-pill" href="#" id="dataDropdown" role="button" 
                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-database mr-1"></i> <span class="d-none d-lg-inline">Data</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-sm border-0 shadow-sm rounded-3 py-2" aria-labelledby="dataDropdown">
                        <a class="dropdown-item py-2" href="data.html">
                            <i class="fas fa-table mr-2 text-primary" style="width: 18px;"></i> Data DTSEN
                        </a>
                        <a class="dropdown-item py-2" href="bansos.html">
                            <i class="fas fa-hand-holding-heart mr-2 text-success" style="width: 18px;"></i> Bansos
                        </a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item py-2" href="Pelayanan.html">
                            <i class="fas fa-file-signature mr-2 text-info" style="width: 18px;"></i> Pelayanan SKTM
                        </a>
                    </div>
                </li>

                <!-- Prioritas -->
                <li class="nav-item">
                    <a class="nav-link px-2 rounded-pill" href="prioritas.html">
                        <i class="fas fa-exclamation-triangle mr-1 text-warning"></i> <span class="d-none d-lg-inline">Prioritas</span>
                    </a>
                </li>

                <!-- Dropdown: Unduh Data - DIPENDEK -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle px-2 rounded-pill" href="#" id="unduhDropdown" role="button" 
                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-download mr-1"></i> <span class="d-none d-lg-inline">Unduh</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-sm border-0 shadow-sm rounded-3 py-2" aria-labelledby="unduhDropdown">
                        <a class="dropdown-item py-2" href="arsip.html">
                            <i class="fas fa-archive mr-2 text-secondary" style="width: 18px;"></i> Arsip
                        </a>
                        <a class="dropdown-item py-2" href="unduh.html">
                            <i class="fas fa-file-pdf mr-2 text-danger" style="width: 18px;"></i> Dokumen
                        </a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item py-2" href="laporan.html">
                            <i class="fas fa-chart-bar mr-2 text-primary" style="width: 18px;"></i> Laporan
                        </a>
                        <a class="dropdown-item py-2" href="evaluasi.html">
                            <i class="fas fa-check-circle mr-2 text-success" style="width: 18px;"></i> Evaluasi
                        </a>
                    </div>
                </li>

                <!-- Alur DTSEN - DIPENDEK -->
                <li class="nav-item">
                    <a class="nav-link px-2 rounded-pill" href="alur.html">
                        <i class="fas fa-diagram-project mr-1"></i> <span class="d-none d-lg-inline">Alur</span>
                    </a>
                </li>

                <!-- Ilmu DTSEN - DIPENDEK -->
                <li class="nav-item">
                    <a class="nav-link px-2 rounded-pill" href="ilmu.html">
                        <i class="fas fa-graduation-cap mr-1"></i> <span class="d-none d-lg-inline">Ilmu</span>
                    </a>
                </li>

                <!-- Dropdown: Aplikasi - DIPINDAH KE BELAKANG -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle px-2 rounded-pill" href="#" id="aplikasiDropdown" role="button" 
                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-apps mr-1"></i> <span class="d-none d-lg-inline">Aplikasi</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-sm border-0 shadow-sm rounded-3 py-2" aria-labelledby="aplikasiDropdown">
                        <a class="dropdown-item py-2" href="aplikasi.html">
                            <i class="fas fa-cubes mr-2 text-primary" style="width: 18px;"></i> Aplikasi Pelayanan
                        </a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item py-2" href="verifikasi.html">
                            <i class="fas fa-qrcode mr-2 text-info" style="width: 18px;"></i> Verifikasi
                        </a>
                    </div>
                </li>

                <!-- Wilayah - DIPENDEK -->
                <li class="nav-item">
                    <a class="nav-link px-2 rounded-pill" href="wilayah.html">
                        <i class="fas fa-map-marker-alt mr-1"></i> <span class="d-none d-lg-inline">Wilayah</span>
                    </a>
                </li>

                <!-- Berita - DIPENDEK -->
                <li class="nav-item">
                    <a class="nav-link px-2 rounded-pill" href="berita.html">
                        <i class="fas fa-newspaper mr-1"></i> <span class="d-none d-lg-inline">Berita</span>
                    </a>
                </li>

                <!-- Kontak - DIPENDEK -->
                <li class="nav-item">
                    <a class="nav-link px-2 rounded-pill" href="kontak.html">
                        <i class="fas fa-envelope mr-1"></i> <span class="d-none d-lg-inline">Kontak</span>
                    </a>
                </li>
            </ul>
            
            <!-- Login/User Section - Minimalis -->
            <ul class="navbar-nav ml-2">
                <li class="nav-item" id="loginNav"></li>
            </ul>
        </div>
    </div>
</nav>

<style>
/* ===== NAVBAR RAPAT & TIDAK LEBAR ===== */
.navbar {
    background: rgba(255, 255, 255, 0.98) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.03);
    transition: all 0.3s ease;
    padding-top: 8px;
    padding-bottom: 8px;
}

.navbar-brand {
    font-weight: 700;
    transition: all 0.2s;
    padding: 0;
}

.navbar-brand span {
    font-size: 0.9rem !important;
    letter-spacing: -0.2px;
}

.navbar-brand:hover {
    transform: translateY(-1px);
}

/* Navbar Links - LEBIH RAPAT */
.navbar-nav {
    gap: 0px !important;
}

.navbar-nav .nav-item .nav-link {
    font-weight: 500;
    font-size: 0.85rem !important;
    color: #2c3e50 !important;
    transition: all 0.2s ease;
    border-radius: 30px;
    padding: 0.4rem 0.7rem !important;
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
}

.navbar-nav .nav-item .nav-link i {
    font-size: 0.85rem;
    transition: transform 0.2s;
}

.navbar-nav .nav-item .nav-link:hover {
    background: rgba(13, 110, 253, 0.08);
    color: #0d6efd !important;
}

.navbar-nav .nav-item .nav-link.active {
    background: #0d6efd !important;
    color: white !important;
    font-weight: 600;
    box-shadow: 0 2px 8px rgba(13, 110, 253, 0.2);
}

/* Dropdown Menu - LEBIH KECIL */
.dropdown-menu {
    border: none;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    border-radius: 14px;
    padding: 8px 0;
    margin-top: 6px;
    animation: fadeInDown 0.2s ease;
    min-width: 200px;
    font-size: 0.85rem;
    border: 1px solid rgba(0,0,0,0.02);
}

@keyframes fadeInDown {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
}

.dropdown-item {
    padding: 0.5rem 1.2rem;
    font-size: 0.85rem;
    color: #2c3e50;
    transition: all 0.2s;
    display: flex;
    align-items: center;
}

.dropdown-item i {
    width: 18px;
    text-align: center;
    font-size: 0.85rem;
    transition: transform 0.2s;
    margin-right: 10px;
}

.dropdown-item:hover {
    background: rgba(13, 110, 253, 0.06);
    color: #0d6efd;
}

/* Mobile Toggle Button - LEBIH KECIL */
.navbar-toggler {
    border: none;
    padding: 6px 10px;
    border-radius: 10px;
    background: rgba(13, 110, 253, 0.05);
}

.navbar-toggler-icon {
    width: 1.2em;
    height: 1.2em;
}

/* ===== MOBILE OPTIMIZATION ===== */
@media (max-width: 1199.98px) {
    .navbar-nav .nav-item .nav-link span {
        display: none !important;
    }
    
    .navbar-nav .nav-item .nav-link i {
        margin-right: 0;
        font-size: 1rem;
    }
    
    .navbar-nav .nav-item .nav-link {
        padding: 0.4rem 0.6rem !important;
    }
}

@media (max-width: 991.98px) {
    .navbar-brand span {
        display: none !important;
    }
    
    .navbar-brand img {
        height: 35px;
    }
    
    .navbar-collapse {
        background: white;
        border-radius: 16px;
        padding: 12px;
        margin-top: 12px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        max-height: 85vh;
        overflow-y: auto;
    }
    
    .navbar-nav {
        width: 100%;
    }
    
    .navbar-nav .nav-item {
        width: 100%;
        margin: 2px 0 !important;
    }
    
    .navbar-nav .nav-item .nav-link {
        padding: 0.6rem 1rem !important;
        justify-content: flex-start;
        border-radius: 10px;
        font-size: 0.9rem !important;
    }
    
    .navbar-nav .nav-item .nav-link span {
        display: inline !important;
        margin-left: 8px;
    }
    
    .navbar-nav .nav-item .nav-link i {
        margin-right: 12px;
        width: 20px;
    }
    
    .dropdown-menu {
        background: #f8f9fa;
        box-shadow: none;
        margin-left: 15px;
        margin-top: 2px;
        border-radius: 10px;
        width: calc(100% - 15px);
        position: static !important;
        transform: none !important;
        float: none;
    }
    
    .dropdown-item {
        padding: 0.5rem 1rem;
    }
    
    .navbar-nav.ml-2 {
        margin-left: 0 !important;
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid rgba(0,0,0,0.05);
        width: 100%;
    }
    
    #loginNav .nav-link {
        justify-content: center !important;
    }
}

/* ===== LOGIN BUTTON MINIMALIS ===== */
#loginNav .nav-link {
    background: linear-gradient(135deg, #0d6efd, #0b5ed7);
    color: white !important;
    padding: 0.4rem 1.2rem !important;
    border-radius: 30px;
    font-weight: 600;
    font-size: 0.85rem !important;
    box-shadow: 0 3px 8px rgba(13, 110, 253, 0.2);
}

#loginNav .nav-link i {
    color: white !important;
    margin-right: 6px;
}

#loginNav .dropdown-menu {
    min-width: 160px;
    right: 0;
    left: auto;
}

/* ===== DROPDOWN ARROW ===== */
.dropdown-toggle::after {
    margin-left: 0.3em;
    vertical-align: middle;
    border-top: 0.25em solid;
    border-right: 0.25em solid transparent;
    border-left: 0.25em solid transparent;
    transition: transform 0.2s;
}

/* ===== SCROLLBAR HALUS ===== */
.navbar-collapse::-webkit-scrollbar {
    width: 4px;
}

.navbar-collapse::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
}

.navbar-collapse::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 10px;
}
</style>

<script>
// ===== USER AUTHENTICATION FUNCTIONS =====
document.addEventListener('DOMContentLoaded', function() {
    updateLoginNav();
    setActiveNavItem();
});

function getUser() {
    try {
        const userStr = localStorage.getItem('user');
        if (userStr) return JSON.parse(userStr);
    } catch (e) {}
    return null;
}

function logout() {
    localStorage.removeItem('user');
    localStorage.removeItem('token');
    window.location.href = 'login.html';
    return false;
}

function updateLoginNav() {
    const loginNav = document.getElementById("loginNav");
    if (!loginNav) return;
    
    const user = getUser();

    if (!user) {
        loginNav.innerHTML = `
            <a href="login.html" class="nav-link d-flex align-items-center">
                <i class="fas fa-sign-in-alt mr-1"></i> <span class="d-none d-lg-inline">Login</span>
            </a>
        `;
    } else {
        loginNav.innerHTML = `
            <div class="dropdown">
                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" 
                   role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fas fa-user-circle mr-1"></i> <span class="d-none d-lg-inline">${user.username || 'Admin'}</span>
                </a>
                <div class="dropdown-menu dropdown-menu-right border-0 shadow-sm rounded-3 py-2">
                    <a class="dropdown-item py-2" href="admin.html">
                        <i class="fas fa-cog mr-2"></i> Panel Admin
                    </a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item py-2 text-danger" href="#" onclick="logout(); return false;">
                        <i class="fas fa-sign-out-alt mr-2"></i> Logout
                    </a>
                </div>
            </div>
        `;
    }
}

function setActiveNavItem() {
    const currentPath = window.location.pathname.split('/').pop() || 'index.html';
    const currentPage = currentPath.split('?')[0];
    
    document.querySelectorAll('.navbar-nav .nav-link').forEach(link => {
        const href = link.getAttribute('href');
        if (href === currentPage) link.classList.add('active');
        else link.classList.remove('active');
    });
    
    document.querySelectorAll('.dropdown-item').forEach(item => {
        const href = item.getAttribute('href');
        if (href === currentPage) {
            const parentDropdown = item.closest('.dropdown');
            if (parentDropdown) {
                const toggle = parentDropdown.querySelector('.dropdown-toggle');
                if (toggle) toggle.classList.add('active');
            }
        }
    });
}

window.logout = logout;
window.getUser = getUser;
</script>
